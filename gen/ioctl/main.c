//! A small C program which prints out ioctl codes to generate a header file
//! that bindgen can generate bindings from.

#include <stdio.h>

#include <linux/version.h>
#include <linux/ioctl.h>
#include <linux/blkpg.h>
#include <linux/blktrace_api.h>
#include <linux/fiemap.h>
#include <linux/fs.h>
#include <linux/kd.h>
#include <linux/nsfs.h>
#include <linux/vt.h>
#include <linux/termios.h>
#include <linux/sockios.h>
#include <linux/time.h>
#include <linux/types.h>
#if LINUX_VERSION_CODE >= KERNEL_VERSION(4,3,0)
#include <linux/userfaultfd.h>
#endif

#ifdef __powerpc64__
typedef __kernel_loff_t loff_t;
#endif

#define IOCTL_REQUEST(s) \
    printf("#define " #s " %lxul\n", (unsigned long)(s));

int main(void) {
#if defined(__i386__)
    printf("#ifdef __i386__\n");
#elif defined(__x86_64__)
    printf("#ifdef __x86_64__\n");
#elif defined(__arm__)
    printf("#ifdef __arm__\n");
#elif defined(__aarch64__)
    printf("#ifdef __aarch64__\n");
#elif defined(__powerpc__)
    printf("#ifdef __powerpc__\n");
#elif defined(__powerpc64__)
    printf("#ifdef __powerpc64__\n");
#elif defined(__riscv) && __WORDSIZE == 64
    printf("#if defined(__riscv) && __WORDSIZE == 64\n");
#else
#error "unimplemented architecture"
#endif

    IOCTL_REQUEST(FIONREAD);
    IOCTL_REQUEST(FIONBIO);
    IOCTL_REQUEST(FIOCLEX);
    IOCTL_REQUEST(FIONCLEX);
    IOCTL_REQUEST(FIOASYNC);
    IOCTL_REQUEST(FIOQSIZE);

    IOCTL_REQUEST(TCXONC);
    IOCTL_REQUEST(TCFLSH);
    IOCTL_REQUEST(TIOCSCTTY);
    IOCTL_REQUEST(TIOCSPGRP);
    IOCTL_REQUEST(TIOCOUTQ);
    IOCTL_REQUEST(TIOCSTI);
    IOCTL_REQUEST(TIOCSWINSZ);
    IOCTL_REQUEST(TIOCMGET);
    IOCTL_REQUEST(TIOCMBIS);
    IOCTL_REQUEST(TIOCMBIC);
    IOCTL_REQUEST(TIOCMSET);
    IOCTL_REQUEST(TIOCSSOFTCAR);
#ifdef TIOCTTYGSTRUCT
    IOCTL_REQUEST(TIOCTTYGSTRUCT);
#endif
    IOCTL_REQUEST(TIOCLINUX);
    IOCTL_REQUEST(TIOCCONS);
    IOCTL_REQUEST(TIOCSSERIAL);
    IOCTL_REQUEST(TIOCPKT);
    IOCTL_REQUEST(TIOCNOTTY);
    IOCTL_REQUEST(TIOCSETD);
    IOCTL_REQUEST(TIOCSBRK);
    IOCTL_REQUEST(TIOCCBRK);
    IOCTL_REQUEST(TIOCSRS485);
    IOCTL_REQUEST(TIOCSPTLCK);
    IOCTL_REQUEST(TIOCSIG);
    IOCTL_REQUEST(TIOCVHANGUP);
    IOCTL_REQUEST(TIOCSERCONFIG);
    IOCTL_REQUEST(TIOCSERGWILD);
    IOCTL_REQUEST(TIOCSERSWILD);
    IOCTL_REQUEST(TIOCSLCKTRMIOS);
    IOCTL_REQUEST(TIOCSERGSTRUCT);
    IOCTL_REQUEST(TIOCSERGETLSR);
    IOCTL_REQUEST(TIOCSERGETMULTI);
    IOCTL_REQUEST(TIOCSERSETMULTI);
    IOCTL_REQUEST(TIOCMIWAIT);
    IOCTL_REQUEST(TCGETS);
    IOCTL_REQUEST(TCGETA);
    IOCTL_REQUEST(TCSBRK);
    IOCTL_REQUEST(TCSBRKP);
    IOCTL_REQUEST(TCSETA);
    IOCTL_REQUEST(TCSETAF);
    IOCTL_REQUEST(TCSETAW);
    IOCTL_REQUEST(TIOCEXCL);
    IOCTL_REQUEST(TIOCNXCL);
    IOCTL_REQUEST(TIOCGDEV);
    IOCTL_REQUEST(TIOCGEXCL);
    IOCTL_REQUEST(TIOCGICOUNT);
    IOCTL_REQUEST(TIOCGLCKTRMIOS);
    IOCTL_REQUEST(TIOCGPGRP);
    IOCTL_REQUEST(TIOCGPKT);
    IOCTL_REQUEST(TIOCGPTLCK);
    IOCTL_REQUEST(TIOCGPTN);
    IOCTL_REQUEST(TIOCGPTPEER);
    IOCTL_REQUEST(TIOCGRS485);
    IOCTL_REQUEST(TIOCGSERIAL);
    IOCTL_REQUEST(TIOCGSID);
    IOCTL_REQUEST(TIOCGSOFTCAR);
    IOCTL_REQUEST(TIOCGWINSZ);
#ifdef TCGETS2
    IOCTL_REQUEST(TCGETS2);
#endif
#ifdef TCGETX
    IOCTL_REQUEST(TCGETX);
#endif
#ifdef TCSETDTR
    IOCTL_REQUEST(TCSETDTR);
#endif
#ifdef TCSETRTS
    IOCTL_REQUEST(TCSETRTS);
#endif
    IOCTL_REQUEST(TCSETS);
#ifdef TCSETS2
    IOCTL_REQUEST(TCSETS2);
#endif
    IOCTL_REQUEST(TCSETSF);
#ifdef TCSETSF2
    IOCTL_REQUEST(TCSETSF2);
#endif
    IOCTL_REQUEST(TCSETSW);
#ifdef TCSETSW2
    IOCTL_REQUEST(TCSETSW2);
#endif
#ifdef TCSETX
    IOCTL_REQUEST(TCSETX);
#endif
#ifdef TCSETXF
    IOCTL_REQUEST(TCSETXF);
#endif
#ifdef TCSETXW
    IOCTL_REQUEST(TCSETXW);
#endif
#ifdef TIOCGDRAINWAIT
    IOCTL_REQUEST(TIOCGDRAINWAIT);
#endif
#ifdef TIOCGETA
    IOCTL_REQUEST(TIOCGETA);
#endif
#ifdef TIOCGETC
    IOCTL_REQUEST(TIOCGETC);
#endif
    IOCTL_REQUEST(TIOCGETD);
#ifdef TIOCGETP
    IOCTL_REQUEST(TIOCGETP);
#endif
#ifdef TIOCGLTC
    IOCTL_REQUEST(TIOCGLTC);
#endif
#ifdef TIOCGPPS
    IOCTL_REQUEST(TIOCGPPS);
#endif
#ifdef TIOCGPPSEV
    IOCTL_REQUEST(TIOCGPPSEV);
#endif

    IOCTL_REQUEST(BLKSSZGET);
    IOCTL_REQUEST(BLKPBSZGET);
    IOCTL_REQUEST(BLKROSET);
    IOCTL_REQUEST(BLKROGET);
    IOCTL_REQUEST(BLKRRPART);
    IOCTL_REQUEST(BLKGETSIZE);
    IOCTL_REQUEST(BLKFLSBUF);
    IOCTL_REQUEST(BLKRASET);
    IOCTL_REQUEST(BLKRAGET);
    IOCTL_REQUEST(BLKFRASET);
    IOCTL_REQUEST(BLKFRAGET);
    IOCTL_REQUEST(BLKSECTSET);
    IOCTL_REQUEST(BLKSECTGET);
    IOCTL_REQUEST(BLKPG);
    IOCTL_REQUEST(BLKBSZGET);
    IOCTL_REQUEST(BLKBSZSET);
    IOCTL_REQUEST(BLKGETSIZE64);
    IOCTL_REQUEST(BLKTRACESETUP);
    IOCTL_REQUEST(BLKTRACESTART);
    IOCTL_REQUEST(BLKTRACESTOP);
    IOCTL_REQUEST(BLKTRACETEARDOWN);
    IOCTL_REQUEST(BLKDISCARD);
    IOCTL_REQUEST(BLKIOMIN);
    IOCTL_REQUEST(BLKIOOPT);
    IOCTL_REQUEST(BLKALIGNOFF);
    IOCTL_REQUEST(BLKDISCARDZEROES);
    IOCTL_REQUEST(BLKSECDISCARD);
    IOCTL_REQUEST(BLKROTATIONAL);
    IOCTL_REQUEST(BLKZEROOUT);

    // Userfaultfd ioctls.
    IOCTL_REQUEST(UFFDIO_REGISTER);
    IOCTL_REQUEST(UFFDIO_UNREGISTER);
    IOCTL_REQUEST(UFFDIO_WAKE);
    IOCTL_REQUEST(UFFDIO_COPY);
    IOCTL_REQUEST(UFFDIO_ZEROPAGE);
    IOCTL_REQUEST(UFFDIO_WRITEPROTECT);
    IOCTL_REQUEST(UFFDIO_API);

    IOCTL_REQUEST(NS_GET_USERNS);
    IOCTL_REQUEST(NS_GET_PARENT);
    IOCTL_REQUEST(NS_GET_NSTYPE);
#ifdef NS_GET_OWNED_UID
    IOCTL_REQUEST(NS_GET_OWNED_UID);
#endif

    IOCTL_REQUEST(KDGETLED);
    IOCTL_REQUEST(KDSETLED);
    IOCTL_REQUEST(KDGKBLED);
    IOCTL_REQUEST(KDSKBLED);
    IOCTL_REQUEST(KDGKBTYPE);
    IOCTL_REQUEST(KDADDIO);
    IOCTL_REQUEST(KDDELIO);
    IOCTL_REQUEST(KDENABIO);
    IOCTL_REQUEST(KDDISABIO);
    IOCTL_REQUEST(KDSETMODE);
    IOCTL_REQUEST(KDGETMODE);
    IOCTL_REQUEST(KDMKTONE);
    IOCTL_REQUEST(KIOCSOUND);
    IOCTL_REQUEST(GIO_CMAP);
    IOCTL_REQUEST(PIO_CMAP);
    IOCTL_REQUEST(GIO_FONT);
    IOCTL_REQUEST(GIO_FONTX);
    IOCTL_REQUEST(PIO_FONT);
    IOCTL_REQUEST(PIO_FONTX);
    IOCTL_REQUEST(PIO_FONTRESET);
    IOCTL_REQUEST(GIO_SCRNMAP);
    IOCTL_REQUEST(GIO_UNISCRNMAP);
    IOCTL_REQUEST(PIO_SCRNMAP);
    IOCTL_REQUEST(PIO_UNISCRNMAP);
    IOCTL_REQUEST(GIO_UNIMAP);
    IOCTL_REQUEST(PIO_UNIMAP);
    IOCTL_REQUEST(PIO_UNIMAPCLR);
    IOCTL_REQUEST(KDGKBMODE);
    IOCTL_REQUEST(KDSKBMODE);
    IOCTL_REQUEST(KDGKBMETA);
    IOCTL_REQUEST(KDSKBMETA);
    IOCTL_REQUEST(KDGKBENT);
    IOCTL_REQUEST(KDSKBENT);
    IOCTL_REQUEST(KDGKBSENT);
    IOCTL_REQUEST(KDSKBSENT);
    IOCTL_REQUEST(KDGKBDIACR);
    IOCTL_REQUEST(KDGETKEYCODE);
    IOCTL_REQUEST(KDSETKEYCODE);
    IOCTL_REQUEST(KDSIGACCEPT);
    IOCTL_REQUEST(VT_OPENQRY);
    IOCTL_REQUEST(VT_GETMODE);
    IOCTL_REQUEST(VT_SETMODE);
    IOCTL_REQUEST(VT_GETSTATE);
    IOCTL_REQUEST(VT_RELDISP);
    IOCTL_REQUEST(VT_ACTIVATE);
    IOCTL_REQUEST(VT_WAITACTIVE);
    IOCTL_REQUEST(VT_DISALLOCATE);
    IOCTL_REQUEST(VT_RESIZE);
    IOCTL_REQUEST(VT_RESIZEX);
    IOCTL_REQUEST(FIOSETOWN);
    IOCTL_REQUEST(SIOCSPGRP);
    IOCTL_REQUEST(FIOGETOWN);
    IOCTL_REQUEST(SIOCGPGRP);
    IOCTL_REQUEST(SIOCATMARK);
    IOCTL_REQUEST(SIOCGSTAMP);
    IOCTL_REQUEST(TIOCINQ);
    IOCTL_REQUEST(SIOCADDRT);
    IOCTL_REQUEST(SIOCDELRT);
    IOCTL_REQUEST(SIOCGIFNAME);
    IOCTL_REQUEST(SIOCSIFLINK);
    IOCTL_REQUEST(SIOCGIFCONF);
    IOCTL_REQUEST(SIOCGIFFLAGS);
    IOCTL_REQUEST(SIOCSIFFLAGS);
    IOCTL_REQUEST(SIOCGIFADDR);
    IOCTL_REQUEST(SIOCSIFADDR);
    IOCTL_REQUEST(SIOCGIFDSTADDR);
    IOCTL_REQUEST(SIOCSIFDSTADDR);
    IOCTL_REQUEST(SIOCGIFBRDADDR);
    IOCTL_REQUEST(SIOCSIFBRDADDR);
    IOCTL_REQUEST(SIOCGIFNETMASK);
    IOCTL_REQUEST(SIOCSIFNETMASK);
    IOCTL_REQUEST(SIOCGIFMETRIC);
    IOCTL_REQUEST(SIOCSIFMETRIC);
    IOCTL_REQUEST(SIOCGIFMEM);
    IOCTL_REQUEST(SIOCSIFMEM);
    IOCTL_REQUEST(SIOCGIFMTU);
    IOCTL_REQUEST(SIOCSIFMTU);
    IOCTL_REQUEST(SIOCSIFHWADDR);
    IOCTL_REQUEST(SIOCGIFENCAP);
    IOCTL_REQUEST(SIOCSIFENCAP);
    IOCTL_REQUEST(SIOCGIFHWADDR);
    IOCTL_REQUEST(SIOCGIFSLAVE);
    IOCTL_REQUEST(SIOCSIFSLAVE);
    IOCTL_REQUEST(SIOCADDMULTI);
    IOCTL_REQUEST(SIOCDELMULTI);
    IOCTL_REQUEST(SIOCDARP);
    IOCTL_REQUEST(SIOCGARP);
    IOCTL_REQUEST(SIOCSARP);
    IOCTL_REQUEST(SIOCDRARP);
    IOCTL_REQUEST(SIOCGRARP);
    IOCTL_REQUEST(SIOCSRARP);
    IOCTL_REQUEST(SIOCGIFMAP);
    IOCTL_REQUEST(SIOCSIFMAP);

    IOCTL_REQUEST(FIBMAP);
    IOCTL_REQUEST(FIGETBSZ);
    IOCTL_REQUEST(FIFREEZE);
    IOCTL_REQUEST(FITHAW);
    IOCTL_REQUEST(FITRIM);
    IOCTL_REQUEST(FICLONE);
    IOCTL_REQUEST(FICLONERANGE);
    IOCTL_REQUEST(FIDEDUPERANGE);

    IOCTL_REQUEST(FS_IOC_GETFLAGS);
    IOCTL_REQUEST(FS_IOC_SETFLAGS);
    IOCTL_REQUEST(FS_IOC_GETVERSION);
    IOCTL_REQUEST(FS_IOC_SETVERSION);
    IOCTL_REQUEST(FS_IOC_FIEMAP);
    IOCTL_REQUEST(FS_IOC32_GETFLAGS);
    IOCTL_REQUEST(FS_IOC32_SETFLAGS);
    IOCTL_REQUEST(FS_IOC32_GETVERSION);
    IOCTL_REQUEST(FS_IOC32_SETVERSION);
    IOCTL_REQUEST(FS_IOC_FSGETXATTR);
    IOCTL_REQUEST(FS_IOC_FSSETXATTR);
    IOCTL_REQUEST(FS_IOC_GETFSLABEL);
    IOCTL_REQUEST(FS_IOC_SETFSLABEL);

    printf("#endif\n");

    return ferror(stdout) != 0;
}
